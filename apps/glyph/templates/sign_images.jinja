{% extends "base.jinja" %}
{% set active_page = "signs" %}
{% from "_utils.jinja" import render_pagination %}
{% block title %}CDP: All images for {{ sign.sign_ref }}{% endblock %}
{% block content %}
    <div class="container-fluid">
        {% for instance in sign.instances %}
            <div class="thumbnail">
                <a href="{{ url_for('static', filename='img/instance/%s.jpg' % instance.filename) }}" class="thumbnail">
                    <img src="{{ url_for('static', filename='img/instance/%s.jpg' % instance.filename) }}" alt="Example of {{ instance.sign.sign_ref }} in {{ instance.tablet.museum_number }}">
                </a>
                <div class="caption">
                    <ul class="list-group">
                        <li class="list-group-item"><strong>Tablet:</strong> <a href="{{ url_for('.tablet_images', tablet_id=instance.tablet.id) }}">{{ instance.tablet.museum_number }}</a></li>
                        <li class="list-group-item"><strong>Line:</strong> {{ instance.line.number }}</li>
                        <li class="list-group-item"><strong>Function:</strong> {{ instance.function.name }}</li>
                    </ul>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}
{% block sidebar %}
    <h3>Sign: <a href="{{ url_for('.cdp', sign_id=sign.id) }}">{{ sign.sign_ref }}</a></h3>
    <h4>{{ sign.instances|length }} {{ 'images' if sign.instances|length > 1 or sign.instances|length == 0 else 'image'}} are available for this sign, on {{ sign.instances|groupby('tablet.museum_number')|length }} tablets:</h4>
    <ul class="list-group">
        {% for group in sign.instances|groupby('tablet.museum_number') %}
            <li class="list-group-item"><strong><a href="{{ url_for(".tablet", tablet_id=group[1][0].tablet.id) }}">{{ group.grouper }} <span class="badge">{{group[1]|length}} {{'instances' if group[1]|length > 1 else 'instance' }}</span></a></strong></li>
        {% endfor %}
    </ul>
{% endblock %}
